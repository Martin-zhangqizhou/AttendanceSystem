{"remainingRequest":"C:\\Users\\springV\\Desktop\\font\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\springV\\Desktop\\font\\src\\views\\image\\components\\image-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\springV\\Desktop\\font\\src\\views\\image\\components\\image-list.vue","mtime":1606908413765},{"path":"C:\\Users\\springV\\Desktop\\font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\springV\\Desktop\\font\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\springV\\Desktop\\font\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\springV\\Desktop\\font\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBnZXRJbWFnZXMsDQogIGNvbGxlY3RJbWFnZSwNCiAgZGVsZXRlSW1hZ2UNCn0gZnJvbSAnQC9hcGkvaW1hZ2UnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0ltYWdlTGlzdCcsDQogIGNvbXBvbmVudHM6IHt9LA0KICAvLyDkvb/nlKjlr7nosaHnmoTmlrnlvI/lrprkuYkgcHJvcO+8jOabtOS4peiwqO+8jOWKn+iDveabtOS4sOWvjO+8jOW8uueDiOW7uuiuruWcqOmhueebruS4reS9v+eUqA0KICAvLyDlj4LogIPmlofmoaPvvJpodHRwczovL2NuLnZ1ZWpzLm9yZy92Mi9ndWlkZS9jb21wb25lbnRzLXByb3BzLmh0bWwjUHJvcC0lRTklQUElOEMlRTglQUYlODENCiAgcHJvcHM6IHsNCiAgICBmb286IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgZGVmYXVsdDogMTIzDQogICAgfSwNCiAgICAvLyDmmK/lkKbmmL7npLrmt7vliqDntKDmnZANCiAgICBpc1Nob3dBZGQ6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sIC8vIOW4g+WwlOWAvA0KICAgICAgZGVmYXVsdDogdHJ1ZSAvLyDpu5jorqTlgLwNCiAgICB9LA0KDQogICAgLy8g5piv5ZCm5pi+56S65Zu+54mH5LiL5pa555qE5pON5L2c77yI5pS26JeP5ZKM5Yig6Zmk77yJDQogICAgaXNTaG93QWN0aW9uOiB7DQogICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgZGVmYXVsdDogdHJ1ZQ0KICAgIH0sDQoNCiAgICBpc1Nob3dTZWxlY3RlZDogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfQ0KICB9LA0KICAvLyDkvb/nlKjmlbDnu4Tlo7DmmI4gcHJvcO+8jOS4jeW7uuiuru+8jOS4jeWkn+S4peiwqO+8jOiAjOS4lOWKn+iDveS5n+S4jeWkn+W8uuWkp++8jOS7hemAguWQiCBkZW1vIOa8lOekug0KICAvLyBwcm9wczogWydkc2Fkc2Fkc2EnXSwNCiAgZGF0YSAoKSB7DQogICAgY29uc3QgdXNlciA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyJykpDQogICAgcmV0dXJuIHsNCiAgICAgIGNvbGxlY3Q6IGZhbHNlLCAvLyDpu5jorqTmn6Xor6Llhajpg6jntKDmnZDliJfooagNCiAgICAgIGltYWdlczogW10sIC8vIOWbvueJh+e0oOadkOWIl+ihqA0KICAgICAgZGlhbG9nVXBsb2FkVmlzaWJsZTogZmFsc2UsDQogICAgICB1cGxvYWRIZWFkZXJzOiB7DQogICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt1c2VyLnRva2VufWANCiAgICAgIH0sDQogICAgICB0b3RhbENvdW50OiAwLCAvLyDmgLvmlbDmja7mnaHmlbANCiAgICAgIHBhZ2VTaXplOiAyMCwgLy8g5q+P6aG15aSn5bCPDQogICAgICBwYWdlOiAxLCAvLyDlvZPliY3pobXnoIENCiAgICAgIHNlbGVjdGVkOiBudWxsIC8vIOmAieS4reeahOe0ouW8lQ0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHt9LA0KICB3YXRjaDoge30sDQogIGNyZWF0ZWQgKCkgew0KICAgIC8vIOmhtemdouWIneWni+WMluWKoOi9veesrCAxIOmhteaVsOaNrg0KICAgIHRoaXMubG9hZEltYWdlcygxKQ0KICB9LA0KICBtb3VudGVkICgpIHt9LA0KICBtZXRob2RzOiB7DQogICAgbG9hZEltYWdlcyAocGFnZSA9IDEpIHsNCiAgICAgIC8vIOmHjee9rumrmOS6rumhteegge+8jOmYsuatouaVsOaNruWSjOmhteeggeS4jeWvueW6lA0KICAgICAgdGhpcy5wYWdlID0gcGFnZQ0KICAgICAgZ2V0SW1hZ2VzKHsNCiAgICAgICAgY29sbGVjdDogdGhpcy5jb2xsZWN0LA0KICAgICAgICBwYWdlLA0KICAgICAgICBwZXJfcGFnZTogdGhpcy5wYWdlU2l6ZQ0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzLmRhdGEuZGF0YS5yZXN1bHRzDQogICAgICAgIHJlc3VsdHMuZm9yRWFjaChpbWcgPT4gew0KICAgICAgICAgIC8vIGltZyDlr7nosaHmnKzmnaXmsqHmnIkgbG9hZGluZyDmlbDmja4NCiAgICAgICAgICAvLyDmiJHku6zov5nph4zmlLbliLDnmoTlvoDph4zpnaLmt7vliqDor6XmlbDmja7mmK/nlKjmnaXmjqfliLbmr4/kuKrmlLbol4/mjInpkq7nmoQgbG9hZGluZyDnirbmgIENCiAgICAgICAgICBpbWcubG9hZGluZyA9IGZhbHNlDQogICAgICAgIH0pDQogICAgICAgIHRoaXMuaW1hZ2VzID0gcmVzdWx0cw0KICAgICAgICB0aGlzLnRvdGFsQ291bnQgPSByZXMuZGF0YS5kYXRhLnRvdGFsX2NvdW50DQogICAgICB9KQ0KICAgIH0sDQoNCiAgICAvLyBvbkNvbGxlY3RDaGFuZ2UgKCkgew0KICAgIC8vICAgdGhpcy5sb2FkSW1hZ2VzKDEpDQogICAgLy8gfSwNCg0KICAgIG9uVXBsb2FkU3VjY2VzcyAoKSB7DQogICAgICAvLyDlhbPpl63lr7nor53moYYNCiAgICAgIHRoaXMuZGlhbG9nVXBsb2FkVmlzaWJsZSA9IGZhbHNlDQoNCiAgICAgIC8vIOabtOaWsOe0oOadkOWIl+ihqA0KICAgICAgdGhpcy5sb2FkSW1hZ2VzKHRoaXMucGFnZSkNCg0KICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgbWVzc2FnZTogJ+S4iuS8oOaIkOWKnycNCiAgICAgIH0pDQogICAgfSwNCg0KICAgIG9uUGFnZUNoYW5nZSAocGFnZSkgew0KICAgICAgdGhpcy5sb2FkSW1hZ2VzKHBhZ2UpDQogICAgfSwNCg0KICAgIG9uQ29sbGVjdCAoaW1nKSB7DQogICAgICAvLyDlsZXnpLogbG9hZGluZw0KICAgICAgaW1nLmxvYWRpbmcgPSB0cnVlDQogICAgICBjb2xsZWN0SW1hZ2UoaW1nLmlkLCAhaW1nLmlzX2NvbGxlY3RlZCkudGhlbihyZXMgPT4gew0KICAgICAgICAvLyDmm7TmlrDop4blm77nirbmgIENCiAgICAgICAgaW1nLmlzX2NvbGxlY3RlZCA9ICFpbWcuaXNfY29sbGVjdGVkDQogICAgICAgIC8vIOWFs+mXrSBsb2FkaW5nDQogICAgICAgIGltZy5sb2FkaW5nID0gZmFsc2UNCiAgICAgIH0pDQogICAgICAvLyBpZiAoaW1nLmlzX2NvbGxlY3RlZCkgew0KICAgICAgLy8gICAvLyDlt7LmlLbol4/vvIzlj5bmtojmlLbol48NCiAgICAgIC8vICAgY29sbGVjdEltYWdlKGltZy5pZCwgZmFsc2UpDQogICAgICAvLyB9IGVsc2Ugew0KICAgICAgLy8gICAvLyDmsqHmnInmlLbol4/vvIzmt7vliqDmlLbol48NCiAgICAgIC8vICAgY29sbGVjdEltYWdlKGltZy5pZCwgdHJ1ZSkNCiAgICAgIC8vIH0NCiAgICB9LA0KDQogICAgb25EZWxldGUgKGltZykgew0KICAgICAgaW1nLmxvYWRpbmcgPSB0cnVlDQogICAgICBkZWxldGVJbWFnZShpbWcuaWQpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgLy8g6YeN5paw5Yqg6L295pWw5o2u5YiX6KGoDQogICAgICAgIHRoaXMubG9hZEltYWdlcyh0aGlzLnBhZ2UpDQogICAgICAgIGltZy5sb2FkaW5nID0gZmFsc2UNCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["image-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"image-list.vue","sourceRoot":"src/views/image/components","sourcesContent":["<template>\r\n  <div class=\"image-list\">\r\n    <div class=\"action-head\">\r\n      <el-radio-group\r\n        v-model=\"collect\"\r\n        size=\"mini\"\r\n        @change=\"loadImages(1)\"\r\n      >\r\n        <el-radio-button\r\n          :label=\"false\"\r\n        >全部</el-radio-button>\r\n        <el-radio-button\r\n          :label=\"true\"\r\n        >收藏</el-radio-button>\r\n      </el-radio-group>\r\n      <el-button\r\n        v-if=\"isShowAdd\"\r\n        size=\"mini\"\r\n        type=\"success\"\r\n        @click=\"dialogUploadVisible = true\"\r\n      >上传素材</el-button>\r\n    </div>\r\n    <!-- 素材列表 -->\r\n    <el-row :gutter=\"10\">\r\n      <el-col\r\n        :xs=\"12\"\r\n        :sm=\"6\"\r\n        :md=\"6\"\r\n        :lg=\"4\"\r\n        v-for=\"(img, index) in images\"\r\n        :key=\"index\"\r\n        class=\"image-item\"\r\n        @click.native=\"selected = index\"\r\n      >\r\n        <el-image\r\n          style=\"height: 100px\"\r\n          :src=\"img.url\"\r\n          fit=\"cover\"\r\n        ></el-image>\r\n        <div\r\n          class=\"selected\"\r\n          v-if=\"isShowSelected && selected === index\"\r\n        ></div>\r\n        <div v-if=\"isShowAction\" class=\"image-action\">\r\n          <!--\r\n            class 样式绑定\r\n             {\r\n                CSS类名: 布尔值\r\n             }\r\n             true：作用类名\r\n             false：不作用类名\r\n           -->\r\n          <el-button\r\n            type=\"warning\"\r\n            :icon=\"img.is_collected ? 'el-icon-star-on' : 'el-icon-star-off'\"\r\n            circle\r\n            size=\"small\"\r\n            @click=\"onCollect(img)\"\r\n            :loading=\"img.loading\"\r\n          ></el-button>\r\n          <el-button\r\n            size=\"small\"\r\n            type=\"danger\"\r\n            icon=\"el-icon-delete-solid\"\r\n            circle\r\n            :loading=\"img.loading\"\r\n            @click=\"onDelete(img)\"\r\n          ></el-button>\r\n          <!-- <i\r\n            :class=\"{\r\n              'el-icon-star-on': img.is_collected,\r\n              'el-icon-star-off': !img.is_collected\r\n            }\"\r\n            @click=\"onCollect(img)\"\r\n          ></i> -->\r\n          <!-- <i class=\"el-icon-delete-solid\"></i> -->\r\n          <!-- <el-button size=\"mini\" icon=\"el-icon-delete-solid\" circle></el-button> -->\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n    <!-- /素材列表 -->\r\n\r\n    <!-- 数据分页 -->\r\n    <!--\r\n      分页数据改变以后，页码不会变化\r\n      它需要单独处理高亮的页码\r\n     -->\r\n    <el-pagination\r\n      background\r\n      layout=\"prev, pager, next\"\r\n      :total=\"totalCount\"\r\n      :page-size=\"pageSize\"\r\n      :current-page.sync=\"page\"\r\n      @current-change=\"onPageChange\"\r\n    >\r\n    </el-pagination>\r\n    <!-- /数据分页 -->\r\n\r\n    <el-dialog\r\n      title=\"上传素材\"\r\n      :visible.sync=\"dialogUploadVisible\"\r\n      :append-to-body=\"true\"\r\n    >\r\n      <!--\r\n        upload 组件本身就支持请求提交上传操作，说白了你使用它不用自己去发请求，它会自己发。\r\n        请求方法：默认就是 POST\r\n        请求路径：action，必须写完整路径\r\n        请求头：headers\r\n       -->\r\n      <el-upload\r\n        class=\"upload-demo\"\r\n        drag\r\n        action=\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\"\r\n        :headers=\"uploadHeaders\"\r\n        name=\"image\"\r\n        multiple\r\n        :show-file-list=\"false\"\r\n        :on-success=\"onUploadSuccess\"\r\n      >\r\n        <i class=\"el-icon-upload\"></i>\r\n        <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n        <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n      </el-upload>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getImages,\r\n  collectImage,\r\n  deleteImage\r\n} from '@/api/image'\r\n\r\nexport default {\r\n  name: 'ImageList',\r\n  components: {},\r\n  // 使用对象的方式定义 prop，更严谨，功能更丰富，强烈建议在项目中使用\r\n  // 参考文档：https://cn.vuejs.org/v2/guide/components-props.html#Prop-%E9%AA%8C%E8%AF%81\r\n  props: {\r\n    foo: {\r\n      type: Number,\r\n      // required: true,\r\n      default: 123\r\n    },\r\n    // 是否显示添加素材\r\n    isShowAdd: {\r\n      type: Boolean, // 布尔值\r\n      default: true // 默认值\r\n    },\r\n\r\n    // 是否显示图片下方的操作（收藏和删除）\r\n    isShowAction: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n\r\n    isShowSelected: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  // 使用数组声明 prop，不建议，不够严谨，而且功能也不够强大，仅适合 demo 演示\r\n  // props: ['dsadsadsa'],\r\n  data () {\r\n    const user = JSON.parse(window.localStorage.getItem('user'))\r\n    return {\r\n      collect: false, // 默认查询全部素材列表\r\n      images: [], // 图片素材列表\r\n      dialogUploadVisible: false,\r\n      uploadHeaders: {\r\n        Authorization: `Bearer ${user.token}`\r\n      },\r\n      totalCount: 0, // 总数据条数\r\n      pageSize: 20, // 每页大小\r\n      page: 1, // 当前页码\r\n      selected: null // 选中的索引\r\n    }\r\n  },\r\n  computed: {},\r\n  watch: {},\r\n  created () {\r\n    // 页面初始化加载第 1 页数据\r\n    this.loadImages(1)\r\n  },\r\n  mounted () {},\r\n  methods: {\r\n    loadImages (page = 1) {\r\n      // 重置高亮页码，防止数据和页码不对应\r\n      this.page = page\r\n      getImages({\r\n        collect: this.collect,\r\n        page,\r\n        per_page: this.pageSize\r\n      }).then(res => {\r\n        const results = res.data.data.results\r\n        results.forEach(img => {\r\n          // img 对象本来没有 loading 数据\r\n          // 我们这里收到的往里面添加该数据是用来控制每个收藏按钮的 loading 状态\r\n          img.loading = false\r\n        })\r\n        this.images = results\r\n        this.totalCount = res.data.data.total_count\r\n      })\r\n    },\r\n\r\n    // onCollectChange () {\r\n    //   this.loadImages(1)\r\n    // },\r\n\r\n    onUploadSuccess () {\r\n      // 关闭对话框\r\n      this.dialogUploadVisible = false\r\n\r\n      // 更新素材列表\r\n      this.loadImages(this.page)\r\n\r\n      this.$message({\r\n        type: 'success',\r\n        message: '上传成功'\r\n      })\r\n    },\r\n\r\n    onPageChange (page) {\r\n      this.loadImages(page)\r\n    },\r\n\r\n    onCollect (img) {\r\n      // 展示 loading\r\n      img.loading = true\r\n      collectImage(img.id, !img.is_collected).then(res => {\r\n        // 更新视图状态\r\n        img.is_collected = !img.is_collected\r\n        // 关闭 loading\r\n        img.loading = false\r\n      })\r\n      // if (img.is_collected) {\r\n      //   // 已收藏，取消收藏\r\n      //   collectImage(img.id, false)\r\n      // } else {\r\n      //   // 没有收藏，添加收藏\r\n      //   collectImage(img.id, true)\r\n      // }\r\n    },\r\n\r\n    onDelete (img) {\r\n      img.loading = true\r\n      deleteImage(img.id).then(res => {\r\n        // 重新加载数据列表\r\n        this.loadImages(this.page)\r\n        img.loading = false\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.action-head {\r\n  padding-bottom: 20px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.image-item {\r\n  position: relative;\r\n}\r\n\r\n.image-action {\r\n  font-size: 25px;\r\n  display: flex;\r\n  justify-content: space-evenly;\r\n  align-items: center;\r\n  color: #fff;\r\n  height: 40px;\r\n  background-color: rgba(204, 204, 204, .5);\r\n  position: absolute;\r\n  bottom: 4px;\r\n  left: 5px;\r\n  right: 5px;\r\n}\r\n\r\n.selected {\r\n  background: url(./selected.png) no-repeat;\r\n  background-size: cover;\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  top: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n</style>\r\n"]}]}