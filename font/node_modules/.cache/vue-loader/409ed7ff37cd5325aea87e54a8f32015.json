{"remainingRequest":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\src\\views\\publish\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\src\\views\\publish\\index.vue","mtime":1607177356888},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCiAgaW1wb3J0IHsgZ2V0QXJ0aWNsZUNoYW5uZWxzLCBhZGRBcnRpY2xlLCB1cGRhdGVBcnRpY2xlLCBnZXRBcnRpY2xlIH0gZnJvbSAiQC9hcGkvYXJ0aWNsZSI7CgogIGV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHVibGlzaEluZGV4JywKICBwcm9wczoge30sCiAgY29tcG9uZW50czogewogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBjaGFubmVsczogW10sCiAgICAgIGFydGljbGU6IHsKICAgICAgICB0aXRsZTogJycsIC8vIOaWh+eroOagh+mimAogICAgICAgIGNvbnRlbnQgOiAnJywgLy8g5paH56ug5YaF5a65CiAgICAgICAgY292ZXIgOiB7IC8vIOaWh+eroOWwgemdogogICAgICAgICAgdHlwZSA6IDAsIC8vIOWwgemdouexu+WeiyAtMTroh6rliqjvvIwwLeaXoOWbvu+8jDEtMeW8oO+8jDMtM+W8oAogICAgICAgICAgaW1hZ2VzOiBbXSAvLyDlsIHpnaLlm77niYfnmoTlnLDlnYAKICAgICAgICB9LAogICAgICAgIGNoYW5uZWxfaWQ6IG51bGwKICAgICAgfSwKICAgICAgYXJ0aWNsZV9pZDogbnVsbAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRDaGFubmVscygpCgogICAgLy8g55Sx5LqO5oiR5Lus6K6p5Y+R5biD5ZKM5L+u5pS55L2/55So55qE5pivIOWQjOS4gOS4que7hOS7tgogICAgLy8g5omA5Lul6L+Z6YeM6KaB5Yik5patCiAgICAvLyDlpoLmnpzot6/nlLHlj4LmlbDkuK3mnIkgaWQgIOWImeivt+axguWxleekuuaWh+eroOWGheWuuQogICAgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LmlkKSB7CiAgICAgIHRoaXMubG9hZEFydGljbGUoKQogICAgfQogIH0sCiAgbW91bnRlZCgpIHt9LAogIHdhdGNoOiB7CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblB1Ymxpc2goZHJhZnQgPSBmYWxzZSkgewogICAgICBpZiAodGhpcy5hcnRpY2xlX2lkKXsKICAgICAgICB1cGRhdGVBcnRpY2xlKHRoaXMuYXJ0aWNsZV9pZCwgdGhpcy5hcnRpY2xlLCBkcmFmdCkudGhlbihyZXMgPT4gewogICAgICAgICAgY29uc29sZS5sb2cocmVzKQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6IGAke2RyYWZ0ID8gJ+WtmOWFpeiNieeovycgOiAn5Y+R5biDJ33miJDlip9gLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pCiAgICAgICAgICAvLyDot7PovazliLDlhoXlrrnnrqHnkIbpobXpnaIKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvYXJ0aWNsZScpCiAgICAgICAgfSkKICAgICAgfWVsc2UgewogICAgICAgIC8vIOaJvuWIsOaVsOaNruaOpeWPowogICAgICAgIGFkZEFydGljbGUodGhpcy5hcnRpY2xlLCBkcmFmdCkudGhlbihyZXMgPT4gewogICAgICAgICAgY29uc29sZS5sb2cocmVzKQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICflj5HluIPmiJDlip8nLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGxvYWRDaGFubmVscyAoKSB7CiAgICAgIGdldEFydGljbGVDaGFubmVscygpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNoYW5uZWxzID0gcmVzLmRhdGEuZGF0YS5jaGFubmVscwogICAgICB9KQogICAgfSwKICAgIGxvYWRBcnRpY2xlICgpIHsKICAgICAgLy8g5L+u5pS55paH56ugIOWKoOi9veaWh+eroOWGheWuuQogICAgICB0aGlzLmFydGljbGVfaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5pZC50b1N0cmluZygpCiAgICAgIGdldEFydGljbGUodGhpcy5hcnRpY2xlX2lkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5hcnRpY2xlID0gcmVzLmRhdGEuZGF0YQogICAgICB9KQogICAgfQogIH0sCiAgZmlsdGVyczogewogICAgZm5OYW1lOiBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/publish","sourcesContent":["<template>\r\n  <div class=\"publish-container\">\r\n    <el-card class=\"box-card\">\r\n      <div slot=\"header\" class=\"clearfix\">\r\n        <div slot=\"header\" class=\"clearfix\">\r\n          <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n            <el-breadcrumb-item :to=\"{ path: '/' }\">首页</el-breadcrumb-item>\r\n            <el-breadcrumb-item>发布文章</el-breadcrumb-item>\r\n          </el-breadcrumb>\r\n        </div>\r\n      </div>\r\n      <el-form ref=\"form\" :model=\"article\" label-width=\"40px\">\r\n        <el-form-item label=\"标题\">\r\n          <el-input v-model=\"article.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"内容\">\r\n          <el-input type=\"textarea\" v-model=\"article.content\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"封面\">\r\n          <el-radio-group v-model=\"article.cover.type\">\r\n            <el-radio :label=\"1\">单图</el-radio>\r\n            <el-radio :label=\"3\">三图</el-radio>\r\n            <el-radio :label=\"0\">无图</el-radio>\r\n            <el-radio :label=\"-1\">自动</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"频道\">\r\n          <el-select v-model=\"article.channel_id\" placeholder=\"请选择频道\">\r\n            <el-option\r\n              :label=\"channel.name\"\r\n              :value=\"channel.id\"\r\n              v-for=\"(channel, index) in channels\"\r\n              :key=\"index\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"onPublish(false)\">发表</el-button>\r\n          <el-button @click=\"onPublish(true)\">存入草稿</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import { getArticleChannels, addArticle, updateArticle, getArticle } from \"@/api/article\";\r\n\r\n  export default {\r\n  name: 'PublishIndex',\r\n  props: {},\r\n  components: {\r\n  },\r\n  data () {\r\n    return {\r\n      channels: [],\r\n      article: {\r\n        title: '', // 文章标题\r\n        content : '', // 文章内容\r\n        cover : { // 文章封面\r\n          type : 0, // 封面类型 -1:自动，0-无图，1-1张，3-3张\r\n          images: [] // 封面图片的地址\r\n        },\r\n        channel_id: null\r\n      },\r\n      article_id: null\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  created() {\r\n    this.loadChannels()\r\n\r\n    // 由于我们让发布和修改使用的是 同一个组件\r\n    // 所以这里要判断\r\n    // 如果路由参数中有 id  则请求展示文章内容\r\n    if (this.$route.query.id) {\r\n      this.loadArticle()\r\n    }\r\n  },\r\n  mounted() {},\r\n  watch: {\r\n  },\r\n  methods: {\r\n    onPublish(draft = false) {\r\n      if (this.article_id){\r\n        updateArticle(this.article_id, this.article, draft).then(res => {\r\n          console.log(res)\r\n          this.$message({\r\n            message: `${draft ? '存入草稿' : '发布'}成功`,\r\n            type: 'success'\r\n          })\r\n          // 跳转到内容管理页面\r\n          this.$router.push('/article')\r\n        })\r\n      }else {\r\n        // 找到数据接口\r\n        addArticle(this.article, draft).then(res => {\r\n          console.log(res)\r\n          this.$message({\r\n            message: '发布成功',\r\n            type: 'success'\r\n          })\r\n        })\r\n      }\r\n    },\r\n    loadChannels () {\r\n      getArticleChannels().then(res => {\r\n        this.channels = res.data.data.channels\r\n      })\r\n    },\r\n    loadArticle () {\r\n      // 修改文章 加载文章内容\r\n      this.article_id = this.$route.query.id.toString()\r\n      getArticle(this.article_id).then(res => {\r\n        this.article = res.data.data\r\n      })\r\n    }\r\n  },\r\n  filters: {\r\n    fnName: function (value) {\r\n      return value\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n\r\n</style>\r\n"]}]}