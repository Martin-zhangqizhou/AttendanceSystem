{"remainingRequest":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\thread-loader\\dist\\cjs.js!D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\babel-loader\\lib\\index.js!D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\src\\views\\publish\\components\\upload-cover.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\src\\views\\publish\\components\\upload-cover.vue","mtime":1607394431726},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\webLearn\\Vue\\黑马头条\\后台\\publish-admin-test\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEltYWdlTGlzdCBmcm9tICdAL3ZpZXdzL2ltYWdlL2NvbXBvbmVudHMvaW1hZ2UtbGlzdCc7CmltcG9ydCB7IHVwbG9hZEltYWdlIH0gZnJvbSAnQC9hcGkvaW1hZ2UnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1VwbG9hZENvdmVyJywKICBwcm9wczogWyd2YWx1ZSddLAogIC8vIHByb3BzOiBbJ2NvdmVyLWltYWdlJ10sCiAgY29tcG9uZW50czogewogICAgSW1hZ2VMaXN0OiBJbWFnZUxpc3QKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgYWN0aXZlTmFtZTogJ3NlY29uZCcKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHt9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7fSwKICB3YXRjaDoge30sCiAgbWV0aG9kczogewogICAgc2hvd0NvdmVyU2VsZWN0OiBmdW5jdGlvbiBzaG93Q292ZXJTZWxlY3QoKSB7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgb25GaWxlQ2hhbmdlOiBmdW5jdGlvbiBvbkZpbGVDaGFuZ2UoKSB7CiAgICAgIC8vIOiOt+WPluaWh+S7tuWvueixoQogICAgICB2YXIgZmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKICAgICAgdmFyIGJsb2IgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlKTsKICAgICAgdGhpcy4kcmVmc1sncHJldmlldy1pbWFnZSddLnNyYyA9IGJsb2I7IC8v6Ziy5q2iIOeUqOaIt+mAieaLqeWQjOS4gOS4quaWh+S7tuS4jeinpuWPkWNoYW5nZeS6i+S7tgogICAgICAvL3RoaXMuJHJlZnMuZmlsZS52YWx1ZSA9ICcnCiAgICB9LAogICAgb25Db3ZlckNvbmZpcm06IGZ1bmN0aW9uIG9uQ292ZXJDb25maXJtKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy8g5aaC5p6cIHRhYiDmmK/kuIrkvKDlm77niYfvvIzlubbkuJQgaW5wdXQtZmlsZSDmnInpgInmi6nnmoTmlofku7bvvIzmiY3miafooYzkuIrkvKDlm77niYfnmoTmk43kvZwKICAgICAgaWYgKHRoaXMuYWN0aXZlTmFtZSA9PT0gJ3NlY29uZCcpIHsKICAgICAgICB2YXIgZmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKCiAgICAgICAgaWYgKCFmaWxlKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKCfor7fpgInmi6nmlofku7YnKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIOaJp+ihjOS4iuS8oOaWh+S7tueahOaTjeS9nAoKCiAgICAgICAgdmFyIGZkID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZmQuYXBwZW5kKCdpbWFnZScsIGZpbGUpOwogICAgICAgIHVwbG9hZEltYWdlKGZkKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIC8vIOWFs+mXreW8ueWHuuWxggogICAgICAgICAgX3RoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOyAvLyDlsZXnpLrkuIrkvKDnmoTlm77niYcKCiAgICAgICAgICBfdGhpcy4kcmVmc1snY292ZXItaW1hZ2UnXS5zcmMgPSByZXMuZGF0YS5kYXRhLnVybDsgLy8g5bCG5Zu+54mH5Zyw5Z2A5Y+R6YCB57uZ54i257uE5Lu2CiAgICAgICAgICAvL3RoaXMuJGVtaXQoJ3VwZGF0ZS1jb3ZlcicsIHJlcy5kYXRhLmRhdGEudXJsKQoKICAgICAgICAgIF90aGlzLiRlbWl0KCdpbnB1dCcsIHJlcy5kYXRhLmRhdGEudXJsKTsgLy8gdGhpcy4kZW1pdCgndXBkYXRlLWNvdmVyJywgcmVzLmRhdGEuZGF0YS51cmwpCgogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWN0aXZlTmFtZSA9PT0gJ2ZpcnN0JykgewogICAgICAgIC8vIOi/mOacieS4gOenjee7hOS7tumAmuS/oeaWueW8j++8mueItue7hOS7tuWPr+S7peebtOaOpeiuv+mXruWtkOe7hOS7tuS4reeahOaVsOaNrgogICAgICAgIHZhciBpbWFnZUxpc3QgPSB0aGlzLiRyZWZzWydpbWFnZS1saXN0J107CiAgICAgICAgdmFyIHNlbGVjdGVkID0gaW1hZ2VMaXN0LnNlbGVjdGVkOwoKICAgICAgICBpZiAoc2VsZWN0ZWQgPT09IG51bGwpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoJ+ivt+mAieaLqeWwgemdouWbvueJhycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8g5YWz6Zet5a+56K+d5qGGCgoKICAgICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsgLy8g5L+u5pS554i257uE5Lu257uR5a6a5pWw5o2uCgogICAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgaW1hZ2VMaXN0LmltYWdlc1tzZWxlY3RlZF0udXJsKTsKICAgICAgfQogICAgfQogIH0sCiAgZmlsdGVyczogewogICAgZm5OYW1lOiBmdW5jdGlvbiBmbk5hbWUodmFsdWUpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["upload-cover.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA,OAAA,SAAA,MAAA,qCAAA;AACA,SAAA,WAAA,QAAA,aAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,aADA;AAEA,EAAA,KAAA,EAAA,CAAA,OAAA,CAFA;AAGA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA;AADA,GAJA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,aAAA,EAAA,KADA;AAEA,MAAA,UAAA,EAAA;AAFA,KAAA;AAIA,GAZA;AAaA,EAAA,QAAA,EAAA,EAbA;AAeA,EAAA,OAfA,qBAeA,CAAA,CAfA;AAgBA,EAAA,OAhBA,qBAgBA,CAAA,CAhBA;AAiBA,EAAA,KAAA,EAAA,EAjBA;AAmBA,EAAA,OAAA,EAAA;AACA,IAAA,eADA,6BACA;AACA,WAAA,aAAA,GAAA,IAAA;AACA,KAHA;AAIA,IAAA,YAJA,0BAIA;AACA;AACA,UAAA,IAAA,GAAA,KAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,CAAA,CAAA;AACA,UAAA,IAAA,GAAA,MAAA,CAAA,GAAA,CAAA,eAAA,CAAA,IAAA,CAAA;AACA,WAAA,KAAA,CAAA,eAAA,EAAA,GAAA,GAAA,IAAA,CAJA,CAKA;AACA;AACA,KAXA;AAYA,IAAA,cAZA,4BAYA;AAAA;;AACA;AACA,UAAA,KAAA,UAAA,KAAA,QAAA,EAAA;AACA,YAAA,IAAA,GAAA,KAAA,KAAA,CAAA,IAAA,CAAA,KAAA,CAAA,CAAA,CAAA;;AACA,YAAA,CAAA,IAAA,EAAA;AACA,eAAA,QAAA,CAAA,OAAA;AACA;AACA,SALA,CAMA;;;AACA,YAAA,EAAA,GAAA,IAAA,QAAA,EAAA;AACA,QAAA,EAAA,CAAA,MAAA,CAAA,OAAA,EAAA,IAAA;AAEA,QAAA,WAAA,CAAA,EAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA;AACA,UAAA,KAAA,CAAA,aAAA,GAAA,KAAA,CAFA,CAGA;;AACA,UAAA,KAAA,CAAA,KAAA,CAAA,aAAA,EAAA,GAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,GAAA,CAJA,CAMA;AACA;;AACA,UAAA,KAAA,CAAA,KAAA,CAAA,OAAA,EAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,GAAA,EARA,CASA;;AACA,SAVA;AAWA,OArBA,MAqBA,IAAA,KAAA,UAAA,KAAA,OAAA,EAAA;AACA;AACA,YAAA,SAAA,GAAA,KAAA,KAAA,CAAA,YAAA,CAAA;AACA,YAAA,QAAA,GAAA,SAAA,CAAA,QAAA;;AACA,YAAA,QAAA,KAAA,IAAA,EAAA;AACA,eAAA,QAAA,CAAA,SAAA;AACA;AACA,SAPA,CASA;;;AACA,aAAA,aAAA,GAAA,KAAA,CAVA,CAWA;;AACA,aAAA,KAAA,CAAA,OAAA,EAAA,SAAA,CAAA,MAAA,CAAA,QAAA,EAAA,GAAA;AACA;AACA;AAjDA,GAnBA;AAsEA,EAAA,OAAA,EAAA;AACA,IAAA,MAAA,EAAA,gBAAA,KAAA,EAAA;AACA,aAAA,KAAA;AACA;AAHA;AAtEA,CAAA","sourcesContent":["<template>\r\n  <div class=\"upload-cover\" @click=\"showCoverSelect\">\r\n    <div class=\"cover-wrap\">\r\n      <img\r\n        class=\"cover-image\"\r\n        ref=\"cover-image\"\r\n        :src=\"value\"\r\n      >\r\n    </div>\r\n\r\n    <el-dialog\r\n      title=\"选择封面\"\r\n      :visible.sync=\"dialogVisible\"\r\n      append-to-body\r\n    >\r\n      <el-tabs v-model=\"activeName\" type=\"card\">\r\n        <el-tab-pane label=\"素材库\" name=\"first\">\r\n          <image-list\r\n            :is-show-add=\"false\"\r\n            :is-show-action=\"false\"\r\n            is-show-selected\r\n            :foo=\"666\"\r\n            ref=\"image-list\"\r\n          />\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"上传图片\" name=\"second\">\r\n          <input\r\n            type=\"file\"\r\n            @change=\"onFileChange\"\r\n            ref=\"file\"\r\n          >\r\n          <img\r\n            width=\"100\"\r\n            ref=\"preview-image\"\r\n          >\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"onCoverConfirm\"\r\n        >确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import ImageList from '@/views/image/components/image-list'\r\n  import { uploadImage } from '@/api/image'\r\nexport default {\r\n  name: 'UploadCover',\r\n  props: ['value'],\r\n  // props: ['cover-image'],\r\n  components: {\r\n    ImageList\r\n  },\r\n  data () {\r\n    return {\r\n      dialogVisible :false,\r\n      activeName: 'second'\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  created() {},\r\n  mounted() {},\r\n  watch: {\r\n  },\r\n  methods: {\r\n    showCoverSelect() {\r\n      this.dialogVisible = true\r\n    },\r\n    onFileChange() {\r\n      // 获取文件对象\r\n      const file = this.$refs.file.files[0]\r\n      const blob = window.URL.createObjectURL(file)\r\n      this.$refs['preview-image'].src = blob\r\n      //防止 用户选择同一个文件不触发change事件\r\n      //this.$refs.file.value = ''\r\n    },\r\n    onCoverConfirm() {\r\n      // 如果 tab 是上传图片，并且 input-file 有选择的文件，才执行上传图片的操作\r\n      if (this.activeName === 'second') {\r\n        const file = this.$refs.file.files[0]\r\n        if (!file) {\r\n          this.$message('请选择文件')\r\n          return\r\n        }\r\n        // 执行上传文件的操作\r\n        const fd = new FormData()\r\n        fd.append('image', file)\r\n\r\n        uploadImage(fd).then(res => {\r\n          // 关闭弹出层\r\n          this.dialogVisible = false\r\n          // 展示上传的图片\r\n          this.$refs['cover-image'].src = res.data.data.url\r\n\r\n          // 将图片地址发送给父组件\r\n          //this.$emit('update-cover', res.data.data.url)\r\n          this.$emit('input', res.data.data.url)\r\n          // this.$emit('update-cover', res.data.data.url)\r\n        })\r\n      }else if (this.activeName === 'first'){\r\n        // 还有一种组件通信方式：父组件可以直接访问子组件中的数据\r\n        const imageList = this.$refs['image-list']\r\n        const selected = imageList.selected\r\n        if (selected === null) {\r\n          this.$message('请选择封面图片')\r\n          return\r\n        }\r\n\r\n        // 关闭对话框\r\n        this.dialogVisible = false\r\n        // 修改父组件绑定数据\r\n        this.$emit('input', imageList.images[selected].url)\r\n      }\r\n    }\r\n  },\r\n  filters: {\r\n    fnName: function (value) {\r\n      return value\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n  .cover-wrap {\r\n    width: 150px;\r\n    height: 120px;\r\n    border: 1px solid #000;\r\n    .cover-image {\r\n      height: 120px;\r\n      max-width: 100%;\r\n    }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/views/publish/components"}]}